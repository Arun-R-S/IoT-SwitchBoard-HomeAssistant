var GLOBAL_host="";function updateInnerHtmlForClassNames(e,t){for(var n=document.getElementsByClassName(e),a=0;a<n.length;a++)n[a].innerHTML=t}function updateValueForId(e,t){document.getElementById(e).value=t}function updateNodeValueForClassNames(e,t){for(var n=document.getElementsByClassName(e),a=0;a<n.length;a++)n[a].nodeValue=t}function getWifiSvgForSignal(e){var t="#0cc90cb2",n="#a7a7a7",a=n,s=n,r=n;switch(getStrengthLabel(e)){case"High":n=t,a=t,s=t,r=t;break;case"Mid":a=t,s=t,r=t;break;case"Low":s=t,r=t;break;case"Weak":r=t}return`<svg fill="#000000" height="30px" width="30px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 365.892 365.892" xml:space="preserve">\n    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>\n    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>\n    <g id="SVGRepo_iconCarrier"> <g> \n        <circle fill="${r}" cx="182.945" cy="286.681" r="41.494"></circle> \n        <path fill="${s}" d="M182.946,176.029c-35.658,0-69.337,17.345-90.09,46.398c-5.921,8.288-4.001,19.806,4.286,25.726 c3.249,2.321,6.994,3.438,10.704,3.438c5.754,0,11.423-2.686,15.021-7.724c13.846-19.383,36.305-30.954,60.078-30.954 c23.775,0,46.233,11.571,60.077,30.953c5.919,8.286,17.437,10.209,25.726,4.288c8.288-5.92,10.208-17.438,4.288-25.726 C252.285,193.373,218.606,176.029,182.946,176.029z"></path> \n        <path fill="${a}" d="M182.946,106.873c-50.938,0-99.694,21.749-133.77,59.67c-6.807,7.576-6.185,19.236,1.392,26.044 c3.523,3.166,7.929,4.725,12.32,4.725c5.051-0.001,10.082-2.063,13.723-6.116c27.091-30.148,65.849-47.439,106.336-47.439 s79.246,17.291,106.338,47.438c6.808,7.576,18.468,8.198,26.043,1.391c7.576-6.808,8.198-18.468,1.391-26.043 C282.641,128.621,233.883,106.873,182.946,106.873z"></path> \n        <path fill="${n}" d="M360.611,112.293c-47.209-48.092-110.305-74.577-177.665-74.577c-67.357,0-130.453,26.485-177.664,74.579 c-7.135,7.269-7.027,18.944,0.241,26.079c3.59,3.524,8.255,5.282,12.918,5.281c4.776,0,9.551-1.845,13.161-5.522 c40.22-40.971,93.968-63.534,151.344-63.534c57.379,0,111.127,22.563,151.343,63.532c7.136,7.269,18.812,7.376,26.08,0.242 C367.637,131.238,367.745,119.562,360.611,112.293z"></path> \n    </g> </g>\n    </svg> `}function connectToWifi(e){var t=document.getElementById("ssid"),n=document.getElementById("password");t.value=e,n.value="",n.focus()}function getStrengthLabel(e){return e>=-60?"High":e>=-70?"Mid":e>=-80?"Low":"Weak"}function getEncryptionTypeIcon(e){return 1===e?"":"Unidentified"}function getEncryptionType(e){switch(e){case 1:return"Unencrypted";case 2:return"WEP";case 3:return"WPA";case 4:return"WPA2";case 8:return"WPA/WPA2";default:return"Unidentified"}}function fetchDeviceData(){var e=new XMLHttpRequest,t=GLOBAL_host+"/api/getDeviceDetails";e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200===e.status){var t=JSON.parse(e.responseText);updateInnerHtmlForClassNames("_DeviceName",t.DeviceName),updateInnerHtmlForClassNames("_DeviceId",t.DeviceID),updateInnerHtmlForClassNames("_DeviceFirmwareVersion",t.DeviceFirmwareVersion),updateInnerHtmlForClassNames("_DeviceFirmwareLastUpdatedOn",t.DeviceFirmwareLastUpdatedOn),updateInnerHtmlForClassNames("_DeviceHardware",t.DeviceHardware),updateInnerHtmlForClassNames("_DeviceManufacturer",t.DeviceManufacturer),console.log(t)}else console.error("Request failed with status:",e),alert("Request failed with status:"+e.status)},e.open("GET",t,!0),e.send()}function fetchAvailableWifiData(){document.getElementById("refreshAvailableWifiListBtn").disabled=!0;var e=new XMLHttpRequest,t=GLOBAL_host+"/api/getAvailableWifiList";e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200===e.status){var t=JSON.parse(e.responseText);const n=document.getElementById("availableWifiList");n.innerHTML="",t.networks.forEach((e=>{const t=document.createElement("tr");e.rssi;t.innerHTML=`\n                        <td><span>${getWifiSvgForSignal(e.rssi)}</span>${e.ssid}</td>\n                        <td>${getEncryptionType(e.encryptionType)}</td>\n                        <td><span class="${getStrengthLabel(e.rssi)}">${e.rssi} dBm</span></td>\n                        <td><button onclick="connectToWifi('${e.ssid}')">Connect</button></td>\n                    `,n.appendChild(t)})),document.getElementById("refreshAvailableWifiListBtn").disabled=!1,console.log(t)}else console.error("Request failed with status:",e),alert("Request failed with status:"+e.status)},e.open("GET",t,!0),e.send()}function fetchWiFiData(){var e=new XMLHttpRequest,t=GLOBAL_host+"/api/getWifiDetails";e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200===e.status){var t=JSON.parse(e.responseText);updateValueForId("ssid",t.ssid),updateValueForId("password",t.password),updateInnerHtmlForClassNames("_WifiFirmware",t.firmwareVersion),updateInnerHtmlForClassNames("_WifiIP",t.ip),updateInnerHtmlForClassNames("_WifiMAC",t.mac),updateInnerHtmlForClassNames("_WifiStatus",t.status+" -> "+t.connectedTo),updateInnerHtmlForClassNames("_wifiCurrentStatus",t.status),updateInnerHtmlForClassNames("_WifiSignalStrength",t.signalStrength+" dBm"),updateValueForId("apSSID",t.apSSID),updateValueForId("apPassword",t.apPassword),console.log(t)}else console.error("Request failed with status:",e.status)},e.open("GET",t,!0),e.send()}function fetchMQTTData(){var e=new XMLHttpRequest,t=GLOBAL_host+"/api/getMQTTDetails";e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200===e.status){var t=JSON.parse(e.responseText);updateValueForId("mqttHost",t.mqttHost),updateValueForId("mqttPort",t.mqttPort),updateValueForId("mqttUsername",t.mqttUsername),updateValueForId("mqttPassword",t.mqttPassword),1==t.mqttStatus?updateInnerHtmlForClassNames("_mqttStatus","Connected"):updateInnerHtmlForClassNames("_mqttStatus","Not Connected"),console.log(t)}else console.error("Request failed with status:",e.status)},e.open("GET",t,!0),e.send()}function getSwitchStatusTagBasedOnValue(e,t,n,a){return 1==a?1==n?`<span style='color:red; font-weight:bold;'>${t}</span>`:`<span style='color:green; font-weight:bold;'>${e}</span>`:1==n?`<span style='color:green; font-weight:bold;'>${e}</span>`:`<span style='color:red; font-weight:bold;'>${t}</span>`}function getToggleBasedOnState(e,t,n,a){return 1==a?1==n?e:t:1==n?t:e}function toggleSwitch(e,t,n){document.getElementById(n).disabled=!0;var a=new XMLHttpRequest;a.open("POST",GLOBAL_host+"/api/toggleSwitch",!0);var s=new FormData;s.append("id",e),s.append("stateValue",t),a.onload=function(){200===a.status?(console.log("Data sent successfully"),fetchSwitchesDetails()):(console.error("Error sending data:",a.statusText),alert("Error : "+a.statusText)),document.getElementById(n).disabled=!1},a.onerror=function(){console.error("Error sending data:",a.statusText),alert("Error : "+a.statusText),document.getElementById(n).disabled=!1},a.send(s)}function fetchSwitchesDetails(){document.getElementById("switchesList");var e=new XMLHttpRequest,t=GLOBAL_host+"/api/getSwitchStatusList";e.open("GET",t,!0),e.onload=function(){if(200===e.status){var t=JSON.parse(e.responseText);const n=document.getElementById("switchesList");n.innerHTML="",t.switches.forEach((e=>{const t=document.createElement("tr");e.arrNo;var a=getToggleBasedOnState(e.payloadOn,e.payloadOff,e.status,e.inverseSwitch);t.innerHTML=`\n                    <td>${e.arrNo}</td>\n                    <td>${e.name}</td>\n                    <td>${e.pin}</td>\n                    <td>${e.payloadOn}/${e.payloadOff}</td>\n                    <td>${e.inverseSwitch}</td>\n                    <td>${e.status}</td>\n                    <td>${getSwitchStatusTagBasedOnValue(e.payloadOn,e.payloadOff,e.status,e.inverseSwitch)}</td>\n                    <td><button class='btn btn-secondary' id="mySwitch_${e.arrNo}" onclick="toggleSwitch(${e.arrNo},'${a}','mySwitch_${e.arrNo}')">${a}</button></td>\n                `,n.appendChild(t)}))}else console.error("Error:",e.statusText)},e.onerror=function(){console.error("Error:",e.statusText)},e.send()}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("updateWifiCredBtn").addEventListener("click",(function(){document.getElementById("updateWifiCredBtn").disabled=!0,document.getElementById("updateWifiCredBtnSpinner").style.display="block";var e=new XMLHttpRequest;e.open("POST",GLOBAL_host+"/api/updateWifiCred",!0);var t=new FormData;t.append("ssid",document.getElementById("ssid").value),t.append("password",document.getElementById("password").value),e.onload=function(){200===e.status?(console.log("Data sent successfully"),alert("Updated Successfully - Status "+JSON.parse(e.responseText).status),location.reload()):(console.error("Error sending data:",e.statusText),alert("Error : "+e.statusText)),document.getElementById("updateWifiCredBtnSpinner").style.display="none",document.getElementById("updateWifiCredBtn").disabled=!1},e.onerror=function(){console.error("Error sending data:",e.statusText),alert("Error : "+e.statusText),document.getElementById("updateWifiCredBtnSpinner").style.display="none",document.getElementById("updateWifiCredBtn").disabled=!1},e.send(t)})),document.getElementById("updateMQTTDetailsBtn").addEventListener("click",(function(){document.getElementById("updateMQTTDetailsBtn").disabled=!0,document.getElementById("updateMQTTDetailsBtnSpinner").style.display="block";var e=new XMLHttpRequest;e.open("POST",GLOBAL_host+"/api/updateMQTTDetails",!0);var t=new FormData;t.append("mqttHost",document.getElementById("mqttHost").value),t.append("mqttPort",document.getElementById("mqttPort").value),t.append("mqttUsername",document.getElementById("mqttUsername").value),t.append("mqttPassword",document.getElementById("mqttPassword").value),e.onload=function(){200===e.status?(console.log("Data sent successfully"),alert("Updated Successfully - Status "+JSON.parse(e.responseText).status),location.reload()):(console.error("Error sending data:",e.statusText),alert("Error : "+e.statusText)),document.getElementById("updateMQTTDetailsBtnSpinner").style.display="none",document.getElementById("updateMQTTDetailsBtn").disabled=!1},e.onerror=function(){console.error("Error sending data:",e.statusText),alert("Error : "+e.statusText),document.getElementById("updateMQTTDetailsBtnSpinner").style.display="none",document.getElementById("updateMQTTDetailsBtn").disabled=!1},e.send(t)})),document.getElementById("restartDeviceBtn").addEventListener("click",(function(){var e=new XMLHttpRequest;e.open("GET",GLOBAL_host+"/api/restartDevice",!0),e.onload=function(){200===e.status?(console.log("Successfully"),alert("Restarted Successfully - Status "+JSON.parse(e.responseText).status),location.reload()):(console.error("Error :",e.statusText),alert("Error : "+e.statusText))},e.onerror=function(){console.error("Error :",e.statusText),alert("Error : "+e.statusText)},e.send()}))}));